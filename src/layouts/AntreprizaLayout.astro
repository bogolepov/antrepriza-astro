---
import "@styles/font.css"
import "@styles/init.css"
import "@styles/antrepriza.css"

import theater from '@data/theater.json'

import Header from "@components/header.astro";
import Footer from "@components/footer.astro";
import Reservation from "@react-components/reservation/Reservation";

const { title, description, lang, reservation, robots = "index, follow" } = Astro.props;

const pathname: string = new URL(Astro.request.url).pathname;

let now = new Date();

---

<html lang={lang}>
	<head>
		<meta charset="UTF-8" />
		<meta name="robots" content={robots} />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="Last-Modified" content={now.toUTCString()}>
		<title>{title}</title>
		{
			description && description.length > 0 && 
			<meta name="description" content={description} />
		}		
		<!-- <link rel="icon" href="/images/icon-192.png" type="image/png" /> -->
		<!-- TODO: -->
		<link rel="icon" href="/favicon.ico" sizes="any" />
		<link rel="icon" type="image/png" href="/favicon.png" sizes="any" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<!-- <link rel="apple-touch-icon" href="/apple-touch-icon-180.png" /> -->
		<!-- <link rel="manifest" href="/manifest.webmanifest" /> -->
		<!-- SEO -->
		{
			theater.languages.map(lng => {
				return (
					<link rel="alternate" href={theater.main_website + pathname.replace('/'+lang+'/', '/'+lng.lang_code+'/')} hreflang={lng.lang_code} />
				);
			})
		}
		<link rel="alternate" href={theater.main_website + pathname.replace('/'+lang+'/', '/ru/')} hreflang="x-default" />
		<!-- SEO -->
		<meta name="generator" content={Astro.generator} />
	</head>

	<body class="no-js">

	<script>
		document.addEventListener('DOMContentLoaded', () => {
			removeNoJS();
			initLangEnv();
			initColorMode();
			initHeaderSubMenuListener();
			initHoverModeForTouchScreen();
			initQuestionForm();
		});
	</script>
	<script is:inline src="/js/antrepriza.js" defer></script>

		<div class="wrapper">
			<Header lang={lang} />
			<main class="wrapper-main">
				<slot/>
				{
					(reservation !== 'no') &&
					<Reservation client:only="react" lang={lang}></Reservation>
				}
			</main>
			<Footer lang={lang} />
		</div>
	
	</body>
	
</html>