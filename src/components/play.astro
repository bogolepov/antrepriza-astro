---

import "@styles/play.css"

const {lang, play_id} = Astro.props;

import theater from '@data/theater.json'

import plays_ru from '@data/plays_ru.json'
import plays_de from '@data/plays_de.json'

let plays = (lang === 'de') ? plays_de : plays_ru;
let thisPlay = plays.filter(play => play_id == play.id)[0];

import type { ImageMetadata } from 'astro'
import { Picture } from 'astro:assets'
const images = import.meta.glob<{ default: ImageMetadata }>('/src/assets/*.{jpeg,jpg,png,gif}');

---
<section class="play">
  <h1>{thisPlay.title}</h1>
  <div>{thisPlay.author_full}</div>
  <div class="media_container">
    <div class="media">
      { thisPlay.trailer_embed &&
        <iframe class="trailer float"
          src={thisPlay.trailer_embed} title="YouTube video player" 
          frameborder="0" 
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
          allowfullscreen></iframe>
      }
      { !thisPlay.trailer_embed &&
        <Picture 
          class:list={'image-wrapper-landscape black-white-filter float'} 
          src={images["/src/assets/" + thisPlay.posters.landscape]()} 
          formats={['avif', 'webp']} 
          widths={[280,640,1200]}
          sizes={'(max-width: 320px) 280px, (max-width: 660px) 640px, 1200px'}
          alt={thisPlay.alt_title} />
      } 
    </div>
  </div>
  <div>{thisPlay.genre}</div>
  <div>{thisPlay.age}</div>
  <div>{thisPlay.length}</div>
  <div>{thisPlay.lang}</div>
  <br>
  <div>АКТЕРСКИЙ СОСТАВ</div>
  {
    thisPlay.characters.map(character => {
      return (
        <div>
          {character.name}{character.description && ", " + character.description}
        </div>
      )
    })
  }
</section>
