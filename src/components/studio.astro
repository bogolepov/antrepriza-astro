---
const { lang } = Astro.props;

import dictionary from '@data/dictionary.json'
import theater from '@data/theater.json'
import studio_photos from '@data/studio_photos.json'

import "@styles/swiper-bundle.css"
import '@styles/studio.css'
import '@styles/play_gallery.css'

import type { ImageMetadata } from 'astro'
import { Picture } from 'astro:assets'
const images = import.meta.glob<{ default: ImageMetadata }>('/src/assets/*/*.{jpeg,jpg,png,gif}');

let photos = studio_photos.filter(photo => photo.filename && photo.is_landscape );

---

<section class="studio">
  <h1 class="section-title">{dictionary.menu_studio[lang]}</h1>

  {
    photos.length > 0 && 
    <div class="gallery">
      <h2>{dictionary.photos[lang].toUpperCase()}</h2>
      <div class="studio-gallery">
        <div class="studio-gallery-position" >
          <div class="swiper">
            <div class="swiper-wrapper">
              {
                photos.map(photo => {
                  return (
                    <div class="swiper-slide" >
                      <Picture 
                        class:list={'play-picture'} 
                        src={images["/src/assets/" + photo.suffix + "/" + photo.filename]()} 
                        formats={['avif', 'webp']} 
                        widths={[290, 380, 520, 720]}
                        sizes={'(max-width: 360px) 290px, (max-width: 480px) 380px, (max-width: 640px) 520px, 720px'}
                        alt=""
                        quality="85"
                        loading="lazy" />
                      <div class="swiper-lazy-preloader"></div>
                    </div>
                  )
                })
              }
            </div>
            <div class="swiper-pagination"></div>
            <div class="swiper-button-prev"></div>
            <div class="swiper-button-next"></div>
          </div>
        </div>
      </div>
    </div>
  }

  <div class="page-end"></div>
</section>


<script is:inline src="/js/swiper-bundle.js"></script>
<script>
  let swiper = new Swiper('.swiper', {
    direction: 'horizontal',
    loop: true,
    slidesPerView: 'auto',
    spaceBetween: 90,
    watchOverflow: true,
    speed: 900,
    centeredSlides: true,
    lazyPreloadPrevNext: 1,
  
    pagination: {
      el: '.swiper-pagination',
      clickable: true,
      dynamicBullets: true,
      dynamicMainBullets: 1,
    },

    navigation: {
      nextEl: '.swiper-button-next',
      prevEl: '.swiper-button-prev',
    },
    
    keyboard: {
      enabled: true,
      onlyInViewport: true,
    }

  });
